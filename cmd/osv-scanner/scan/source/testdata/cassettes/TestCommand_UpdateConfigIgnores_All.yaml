---
version: 2
interactions:
  - id: 0
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 1
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 2
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep_with_no_configs
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 3
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep_with_no_configs
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 4
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep_with_removed_config
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 5
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/deep_with_removed_config
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 6
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/global_config_deep
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 7
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 979
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "6.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ajv"
              },
              "version": "8.0.0"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/global_config_deep
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 795
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                },
                {
                  "id": "GHSA-v88g-cgmw-v5xw",
                  "modified": "2024-06-21T21:33:48Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-2g4f-4pwh-qvx6",
                  "modified": "2026-02-20T21:26:03.466898Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "795"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 8
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/global_config_shallow
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 9
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/global_config_shallow
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 10
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/shallow
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 11
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/shallow
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 12
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/shallow_with_removed_config
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 13
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 271
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "package": {
                "ecosystem": "RubyGems",
                "name": "nokogiri"
              },
              "version": "1.18.9"
            },
            {
              "package": {
                "ecosystem": "npm",
                "name": "ansi-html"
              },
              "version": "0.0.1"
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_UpdateConfigIgnores_All/shallow_with_removed_config
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 177
      body: |
        {
          "results": [
            {
              "vulns": [
                {
                  "id": "GHSA-wx95-c6cv-8532",
                  "modified": "2026-02-18T22:11:44.575445Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "177"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s

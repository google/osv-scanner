---
version: 2
interactions:
  - id: 0
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 149
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "1.0.2",
              "package": {
                "name": "balanced-match",
                "ecosystem": "npm"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/absolute_paths_are_automatically_escaped_on_windows
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 16
      body: |
        {
          "results": [
            {}
          ]
        }
      headers:
        Content-Length:
          - "16"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 1
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 149
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "1.0.2",
              "package": {
                "name": "balanced-match",
                "ecosystem": "npm"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/absolute_paths_work_with_explicit_escaping
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 16
      body: |
        {
          "results": [
            {}
          ]
        }
      headers:
        Content-Length:
          - "16"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 2
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 151
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "2.0.4",
              "package": {
                "name": "sentry/sdk",
                "ecosystem": "Packagist"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/empty_is_default
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 16
      body: |
        {
          "results": [
            {}
          ]
        }
      headers:
        Content-Length:
          - "16"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 3
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 882
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "4.0.0",
              "package": {
                "name": "has-flag",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.2",
              "package": {
                "name": "wrappy",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.8",
              "package": {
                "name": "league/flysystem",
                "ecosystem": "Packagist"
              }
            },
            {
              "version": "0.0.1",
              "package": {
                "name": "ansi-html",
                "ecosystem": "npm"
              }
            },
            {
              "version": "0.0.1",
              "package": {
                "name": "ansi-html",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "stdlib",
                "ecosystem": "Go"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "toolchain",
                "ecosystem": "Go"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/multiple,_+_output_order_is_deterministic
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 271
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "GHSA-9f46-5r25-5wfm",
                  "modified": "2024-02-16T08:21:35.601880Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "271"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 4
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 882
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "4.0.0",
              "package": {
                "name": "has-flag",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.2",
              "package": {
                "name": "wrappy",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.8",
              "package": {
                "name": "league/flysystem",
                "ecosystem": "Packagist"
              }
            },
            {
              "version": "0.0.1",
              "package": {
                "name": "ansi-html",
                "ecosystem": "npm"
              }
            },
            {
              "version": "0.0.1",
              "package": {
                "name": "ansi-html",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "stdlib",
                "ecosystem": "Go"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "toolchain",
                "ecosystem": "Go"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/multiple,_+_output_order_is_deterministic_2
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 271
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "GHSA-9f46-5r25-5wfm",
                  "modified": "2024-02-16T08:21:35.601880Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "271"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 5
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 3
      host: api.osv.dev
      body: |
        {}
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/one_lockfile_with_local_path
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 2
      body: |
        {}
      headers:
        Content-Length:
          - "2"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 6
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 760
      host: api.osv.dev
      body: |
        {
          "queries": [
            {
              "version": "4.0.0",
              "package": {
                "name": "has-flag",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.2",
              "package": {
                "name": "wrappy",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.0.8",
              "package": {
                "name": "league/flysystem",
                "ecosystem": "Packagist"
              }
            },
            {
              "version": "0.0.1",
              "package": {
                "name": "ansi-html",
                "ecosystem": "npm"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "stdlib",
                "ecosystem": "Go"
              }
            },
            {
              "version": "1.99.9",
              "package": {
                "name": "toolchain",
                "ecosystem": "Go"
              }
            }
          ]
        }
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_LockfileWithExplicitParseAs/when_an_explicit_parse-as_is_given,_it's_applied_to_that_file
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 189
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "GHSA-9f46-5r25-5wfm",
                  "modified": "2024-02-16T08:21:35.601880Z"
                }
              ]
            },
            {
              "vulns": [
                {
                  "id": "GHSA-whgm-jr23-g3j9",
                  "modified": "2023-11-08T04:05:08.868477Z"
                }
              ]
            },
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "189"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s

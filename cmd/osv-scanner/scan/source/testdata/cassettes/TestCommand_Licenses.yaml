---
version: 2
interactions:
- id: 0
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Licenses_in_summary_mode_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 1
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Licenses_with_expressions
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 2
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Licenses_with_invalid_expression_in_config
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 3
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/No_license_violations_and_show-all-packages_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 4
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 87
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"balanced-match\"},\"version\":\"1.0.2\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_but_license_violations_with_allowlist
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 16
    body: "{\"results\":[{}]}"
    headers:
      Content-Length:
      - "16"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 5
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"RubyGems\",\"name\":\"ast\"},\"version\":\"2.4.2\"},{\"package\":{\"ecosystem\":\"Packagist\",\"name\":\"sentry/sdk\"},\"version\":\"2.0.4\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ansi-html\"},\"version\":\"0.0.8\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"balanced-match\"},\"version\":\"1.0.2\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_with_license_summary
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 6
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"RubyGems\",\"name\":\"ast\"},\"version\":\"2.4.2\"},{\"package\":{\"ecosystem\":\"Packagist\",\"name\":\"sentry/sdk\"},\"version\":\"2.0.4\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ansi-html\"},\"version\":\"0.0.8\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"balanced-match\"},\"version\":\"1.0.2\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_with_license_summary_in_markdown
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 7
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Show_all_Packages_with_license_summary_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 8
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 374
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"Packagist\",\"name\":\"league/flysystem\"},\"version\":\"1.0.8\"},{\"package\":{\"ecosystem\":\"Go\",\"name\":\"stdlib\"},\"version\":\"1.99.9\"},{\"package\":{\"ecosystem\":\"Go\",\"name\":\"toolchain\"},\"version\":\"1.99.9\"},{\"package\":{\"ecosystem\":\"RubyGems\",\"name\":\"ast\"},\"version\":\"2.4.2\"},{\"package\":{\"ecosystem\":\"Packagist\",\"name\":\"sentry/sdk\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_ignored_licenses
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 107
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-9f46-5r25-5wfm\",\"modified\":\"2024-02-16T08:21:35.601880Z\"}]},{},{},{},{}]}"
    headers:
      Content-Length:
      - "107"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 9
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_license_violations_and_show-all-packages_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 10
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"babel\"},\"version\":\"6.23.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"human-signals\"},\"version\":\"5.0.0\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ms\"},\"version\":\"2.1.3\"},{\"package\":{\"ecosystem\":\"npm\",\"name\":\"type-fest\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_license_violations_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 11
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ansi-html\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_all_license_violations_allowlisted
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 12
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ansi-html\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_license_summary
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 13
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"ecosystem\":\"npm\",\"name\":\"ansi-html\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_license_violations_with_allowlist
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s

---
version: 2
interactions:
- id: 0
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Licenses_in_summary_mode_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 1
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Licenses_with_expressions
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 2
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Licenses_with_invalid_expression_in_config
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 3
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/No_license_violations_and_show-all-packages_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 4
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 87
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_but_license_violations_with_allowlist
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 16
    body: "{\"results\":[{}]}"
    headers:
      Content-Length:
      - "16"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 5
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 1388
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"alpine-baselayout\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-baselayout-data\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-keys\",\"ecosystem\":\"Alpine\"},\"version\":\"2.4-r1\"},{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.1\"},{\"package\":{\"name\":\"apk-tools\",\"ecosystem\":\"Alpine\"},\"version\":\"2.12.10-r1\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"busybox-binsh\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"ca-certificates-bundle\",\"ecosystem\":\"Alpine\"},\"version\":\"20220614-r4\"},{\"package\":{\"name\":\"libc-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"0.7.2-r3\"},{\"package\":{\"name\":\"libcrypto3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"libssl3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"musl\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"musl-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"scanelf\",\"ecosystem\":\"Alpine\"},\"version\":\"1.3.5-r1\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"},{\"package\":{\"name\":\"ssl_client\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"zlib\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.13-r0\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_with_license_summary
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 220
    body: "{\"results\":[{},{},{},{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]},{},{},{},{},{},{},{},{},{\"vulns\":[{\"id\":\"CVE-2025-26519\",\"modified\":\"2025-08-05T20:57:02.403959Z\"}]},{},{},{},{},{}]}"
    headers:
      Content-Length:
      - "220"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 6
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 1388
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"alpine-baselayout\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-baselayout-data\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-keys\",\"ecosystem\":\"Alpine\"},\"version\":\"2.4-r1\"},{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.1\"},{\"package\":{\"name\":\"apk-tools\",\"ecosystem\":\"Alpine\"},\"version\":\"2.12.10-r1\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"busybox-binsh\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"ca-certificates-bundle\",\"ecosystem\":\"Alpine\"},\"version\":\"20220614-r4\"},{\"package\":{\"name\":\"libc-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"0.7.2-r3\"},{\"package\":{\"name\":\"libcrypto3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"libssl3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"musl\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"musl-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"scanelf\",\"ecosystem\":\"Alpine\"},\"version\":\"1.3.5-r1\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"},{\"package\":{\"name\":\"ssl_client\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"zlib\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.13-r0\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/No_vulnerabilities_with_license_summary_in_markdown
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 220
    body: "{\"results\":[{},{},{},{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]},{},{},{},{},{},{},{},{},{\"vulns\":[{\"id\":\"CVE-2025-26519\",\"modified\":\"2025-08-05T20:57:02.403959Z\"}]},{},{},{},{},{}]}"
    headers:
      Content-Length:
      - "220"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 7
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Show_all_Packages_with_license_summary_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 8
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 1462
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"alpine-baselayout\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-baselayout-data\",\"ecosystem\":\"Alpine\"},\"version\":\"3.4.0-r0\"},{\"package\":{\"name\":\"alpine-keys\",\"ecosystem\":\"Alpine\"},\"version\":\"2.4-r1\"},{\"package\":{\"name\":\"apk-tools\",\"ecosystem\":\"Alpine\"},\"version\":\"2.12.10-r1\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"busybox-binsh\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"ca-certificates-bundle\",\"ecosystem\":\"Alpine\"},\"version\":\"20220614-r4\"},{\"package\":{\"name\":\"league/flysystem\",\"ecosystem\":\"Packagist\"},\"version\":\"1.0.8\"},{\"package\":{\"name\":\"libc-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"0.7.2-r3\"},{\"package\":{\"name\":\"libcrypto3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"libssl3\",\"ecosystem\":\"Alpine\"},\"version\":\"3.0.8-r0\"},{\"package\":{\"name\":\"musl\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"musl-utils\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.3-r4\"},{\"package\":{\"name\":\"scanelf\",\"ecosystem\":\"Alpine\"},\"version\":\"1.3.5-r1\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"},{\"package\":{\"name\":\"ssl_client\",\"ecosystem\":\"Alpine\"},\"version\":\"1.36.1-r27\"},{\"package\":{\"name\":\"stdlib\",\"ecosystem\":\"Go\"},\"version\":\"1.99.9\"},{\"package\":{\"name\":\"toolchain\",\"ecosystem\":\"Go\"},\"version\":\"1.99.9\"},{\"package\":{\"name\":\"zlib\",\"ecosystem\":\"Alpine\"},\"version\":\"1.2.13-r0\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_ignored_licenses
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 223
    body: "{\"results\":[{},{},{},{},{},{},{},{\"vulns\":[{\"id\":\"GHSA-9f46-5r25-5wfm\",\"modified\":\"2024-02-16T08:21:35.601880Z\"}]},{},{},{},{\"vulns\":[{\"id\":\"CVE-2025-26519\",\"modified\":\"2025-08-05T20:57:02.403959Z\"}]},{},{},{},{},{},{},{}]}"
    headers:
      Content-Length:
      - "223"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 9
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_license_violations_and_show-all-packages_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 10
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 284
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"babel\",\"ecosystem\":\"npm\"},\"version\":\"6.23.0\"},{\"package\":{\"name\":\"human-signals\",\"ecosystem\":\"npm\"},\"version\":\"5.0.0\"},{\"package\":{\"name\":\"ms\",\"ecosystem\":\"npm\"},\"version\":\"2.1.3\"},{\"package\":{\"name\":\"type-fest\",\"ecosystem\":\"npm\"},\"version\":\"4.26.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Some_packages_with_license_violations_in_json
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 11
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_all_license_violations_allowlisted
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 12
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_license_summary
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 13
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.1\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.3
      X-Test-Name:
      - TestCommand_Licenses/Vulnerabilities_and_license_violations_with_allowlist
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 95
    body: "{\"results\":[{\"vulns\":[{\"id\":\"GHSA-whgm-jr23-g3j9\",\"modified\":\"2023-11-08T04:05:08.868477Z\"}]}]}"
    headers:
      Content-Length:
      - "95"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s

---
version: 2
interactions:
- id: 0
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.8\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_directory_with_a_couple_of_specific_extractors_enabled_individually
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 1
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.8\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_directory_with_a_couple_of_specific_extractors_enabled_specified_together
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 2
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.8\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_directory_with_an_extractor_that_does_not_exist
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 3
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 231
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_directory_with_one_specific_extractor_disabled
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 22
    body: "{\"results\":[{},{},{}]}"
    headers:
      Content-Length:
      - "22"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 4
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 300
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.8\"},{\"package\":{\"name\":\"ast\",\"ecosystem\":\"RubyGems\"},\"version\":\"2.4.2\"},{\"package\":{\"name\":\"balanced-match\",\"ecosystem\":\"npm\"},\"version\":\"1.0.2\"},{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_directory_with_one_specific_extractor_enabled_and_the_defaults
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 25
    body: "{\"results\":[{},{},{},{}]}"
    headers:
      Content-Length:
      - "25"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 5
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 89
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"sentry/sdk\",\"ecosystem\":\"Packagist\"},\"version\":\"2.0.4\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_file_with_one_different_extractor_enabled
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 16
    body: "{\"results\":[{}]}"
    headers:
      Content-Length:
      - "16"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s
- id: 6
  request:
    proto: HTTP/1.1
    proto_major: 1
    proto_minor: 1
    content_length: 82
    host: api.osv.dev
    body: "{\"queries\":[{\"package\":{\"name\":\"ansi-html\",\"ecosystem\":\"npm\"},\"version\":\"0.0.8\"}]}"
    headers:
      Content-Type:
      - application/json
      User-Agent:
      - osv-scanner_scan/2.2.4
      X-Test-Name:
      - TestCommand_ExplicitExtractors_WithDefaults/scanning_file_with_one_specific_extractor_enabled
    url: https://api.osv.dev/v1/querybatch
    method: POST
  response:
    proto: HTTP/2.0
    proto_major: 2
    proto_minor: 0
    content_length: 16
    body: "{\"results\":[{}]}"
    headers:
      Content-Length:
      - "16"
      Content-Type:
      - application/json
    status: 200 OK
    code: 200
    duration: 0s

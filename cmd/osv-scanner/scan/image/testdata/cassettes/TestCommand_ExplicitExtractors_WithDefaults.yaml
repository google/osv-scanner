---
version: 2
interactions:
  - id: 0
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 1227
      host: api.osv.dev
      body: '{"queries":[{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-baselayout"},"version":"3.1.2-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-keys"},"version":"2.1-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"apk-tools"},"version":"2.10.6-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"ca-certificates"},"version":"20191127-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"libc-dev"},"version":"0.7.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"libtls-standalone"},"version":"2.9.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"pax-utils"},"version":"1.2.3-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"zlib"},"version":"1.2.11-r1"},{"package":{"ecosystem":"Alpine","name":"zlib"},"version":"1.2.12-r1"}]}'
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_ExplicitExtractors_WithDefaults/add_extractors
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 220
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "ALPINE-CVE-2021-36159",
                  "modified": "2025-12-03T22:50:23.251262Z"
                }
              ]
            },
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {
              "vulns": [
                {
                  "id": "ALPINE-CVE-2022-37434",
                  "modified": "2025-12-03T22:50:43.469206Z"
                }
              ]
            }
          ]
        }
      headers:
        Content-Length:
          - "220"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 1
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 1156
      host: api.osv.dev
      body: '{"queries":[{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-baselayout"},"version":"3.1.2-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-keys"},"version":"2.1-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"apk-tools"},"version":"2.10.6-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"ca-certificates"},"version":"20191127-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"libc-dev"},"version":"0.7.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"libtls-standalone"},"version":"2.9.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"pax-utils"},"version":"1.2.3-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"zlib"},"version":"1.2.11-r1"}]}'
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_ExplicitExtractors_WithDefaults/extractors_cancelled_out
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 136
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "ALPINE-CVE-2021-36159",
                  "modified": "2025-12-03T22:50:23.251262Z"
                }
              ]
            },
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "136"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 2
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 1156
      host: api.osv.dev
      body: '{"queries":[{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-baselayout"},"version":"3.1.2-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-keys"},"version":"2.1-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"apk-tools"},"version":"2.10.6-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"ca-certificates"},"version":"20191127-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"libc-dev"},"version":"0.7.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"libtls-standalone"},"version":"2.9.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"pax-utils"},"version":"1.2.3-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"zlib"},"version":"1.2.11-r1"}]}'
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_ExplicitExtractors_WithDefaults/extractors_cancelled_out#01
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 136
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "ALPINE-CVE-2021-36159",
                  "modified": "2025-12-03T22:50:23.251262Z"
                }
              ]
            },
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "136"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s
  - id: 3
    request:
      proto: HTTP/1.1
      proto_major: 1
      proto_minor: 1
      content_length: 1156
      host: api.osv.dev
      body: '{"queries":[{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-baselayout"},"version":"3.1.2-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"alpine-keys"},"version":"2.1-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"apk-tools"},"version":"2.10.6-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"ca-certificates"},"version":"20191127-r2"},{"package":{"ecosystem":"Alpine:v3.10","name":"libc-dev"},"version":"0.7.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"openssl"},"version":"1.1.1k-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"libtls-standalone"},"version":"2.9.1-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"musl"},"version":"1.1.22-r4"},{"package":{"ecosystem":"Alpine:v3.10","name":"pax-utils"},"version":"1.2.3-r0"},{"package":{"ecosystem":"Alpine:v3.10","name":"busybox"},"version":"1.30.1-r5"},{"package":{"ecosystem":"Alpine:v3.10","name":"zlib"},"version":"1.2.11-r1"}]}'
      headers:
        Content-Type:
          - application/json
        X-Test-Name:
          - TestCommand_ExplicitExtractors_WithDefaults/extractors_cancelled_out_with_presets
      url: https://api.osv.dev/v1/querybatch
      method: POST
    response:
      proto: HTTP/2.0
      proto_major: 2
      proto_minor: 0
      content_length: 136
      body: |
        {
          "results": [
            {},
            {},
            {
              "vulns": [
                {
                  "id": "ALPINE-CVE-2021-36159",
                  "modified": "2025-12-03T22:50:23.251262Z"
                }
              ]
            },
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {},
            {}
          ]
        }
      headers:
        Content-Length:
          - "136"
        Content-Type:
          - application/json
      status: 200 OK
      code: 200
      duration: 0s

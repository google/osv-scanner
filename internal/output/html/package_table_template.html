<table class="vuln-table">
  <tr>
    <th>Package</th>
    <th>Ecosystem</th>
    <th>Installed version</th>
    <th>Fixed version</th>
    <th>Vulnerability Count</th>
  </tr>
  {{ range $rowIndex, $element := . }}
  {{ if eq (len $element.CalledVulns) 0 }}
  {{ continue }}
  {{ end }}

  {{ $randomIndex := random}}
  <tr class='vuln-tr' id="vuln-tr-{{ $element.Name}}-{{ $rowIndex }}-{{ $randomIndex }}"
    onclick="showVulnDetails('{{ $element.Name }}-{{ $rowIndex }}-{{ $randomIndex }}')">
    <td>{{ $element.Name }}</td>
    <td>{{ $element.Ecosystem }}</td>
    <td>{{ $element.InstalledVersion }}</td>
    <td {{ if eq $element.FixedVersion "No fix available" }} class="warning" {{ end }}>{{ $element.FixedVersion }}</td>
    <td>{{ printSeverityCountShort $element.HTMLVulnCount }}</td>
  </tr>
  <tr>
    <td colspan="100%">
      <div id="vuln-details-{{ $element.Name }}-{{ $rowIndex }}-{{ $randomIndex }}" class="vuln-details">
        <p>Source: {{ $element.Source }}
        <p>Vulnerabilities:</p>
        {{ range $index, $vuln := $element.CalledVulns }}
          {{ if eq $element.FixedVersion "No fix available" }}
          <p><a href="https://osv.dev/{{ $vuln.Summary.Id }}">{{ $vuln.Summary.Id }}</a> ({{$vuln.Summary.SeverityRating}}) has no fix available</p>
          {{ else }}
          <p><a href="https://osv.dev/{{ $vuln.Summary.Id }}">{{ $vuln.Summary.Id }}</a> ({{$vuln.Summary.SeverityRating}}) has a fixed version at {{$vuln.Summary.FixedVersion}}(Fixed Version)</p>
          {{ end }}
        {{ end }}
      </div>
    </td>
  </tr>
  {{ end }}
</table>